{"version":3,"sources":["app.js"],"names":["angular","module","config","RestangularProvider","setDefaultHeaders","setFullRequestInterceptor","element","operation","route","url","headers","params","httpConfig","token","sessionStorage","getItem","_","extend","Authorization","BaseCtrl","$rootScope","$state","user","JSON","parse","getServer","buildURL","path","signedIn","signout","clear","window","location","reload","controller","DashboardCtrl","$scope","Restangular","$stateParams","sync","oneUrl","post","then","response","setItems","retrieved_items","syncToken","sync_token","catch","console","log","selectAll","subItems","item","checked","deselect","items","pageSize","currentItemsIndex","paginate","slice","paginatePrev","paginateNext","length","deleteSelectedWithSync","selected","filter","confirm","deleted","request","showDelete","savedItems","saved_items","savedItem","localItem","find","uuid","merge","destroySelected","destroyItems","destroyAll","uuids","map","remove","difference","ExtensionsCtrl","extType","decodeContent","contentString","jsonString","atob","content","getInitialExtensions","extensions","content_type","decodeExtensions","ext","String","performBackupForExt","performingBackup","alert","plain","formData","addExtension","encodedContent","btoa","stringify","push","HomeCtrl","server","email","id","password","pw","submitLogin","setItem","error","data","$stateProvider","$urlRouterProvider","$locationProvider","state","abstract","parent","views","templateUrl","otherwise","$injector","$location","get","go","html5Mode"],"mappings":"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","file":"transpiled.js","sourcesContent":["'use strict';\n\nangular.module('app', [\n  'ui.router',\n  'restangular'\n])\n\n.config(function (RestangularProvider) {\n  RestangularProvider.setDefaultHeaders({\"Content-Type\": \"application/json\"});\n  RestangularProvider.setFullRequestInterceptor(function(element, operation, route, url, headers, params, httpConfig) {\n    var token = sessionStorage.getItem(\"jwt\");\n    if(token) {\n      headers = _.extend(headers, {Authorization: \"Bearer \" + token});\n    }\n\n    return {\n      element: element,\n      params: params,\n      headers: headers,\n      httpConfig: httpConfig\n    };\n  });\n})\n;class BaseCtrl {\n  constructor($rootScope, $state) {\n\n    $rootScope.user = JSON.parse(sessionStorage.getItem(\"user\"));\n\n    $rootScope.getServer = function() {\n      return sessionStorage.getItem(\"server\");\n    }\n\n    $rootScope.buildURL = function(path) {\n      return $rootScope.getServer() + \"/\" + path;\n    }\n\n    $rootScope.signedIn = sessionStorage.getItem(\"jwt\");\n\n    $rootScope.signout = function() {\n      sessionStorage.clear();\n      $rootScope.signedIn = false;\n      window.location.reload();\n    }\n  }\n}\n\nangular.module('app').controller('BaseCtrl', BaseCtrl);\n;class DashboardCtrl {\n  constructor($rootScope, $scope, Restangular, $stateParams) {\n\n    $scope.sync = function() {\n      var url = $rootScope.buildURL(\"items/sync\");\n      Restangular.oneUrl(url, url).post().then(function(response){\n        $scope.setItems(response.retrieved_items);\n        $scope.syncToken = response.sync_token;\n      })\n      .catch(function(response){\n        console.log(\"Error: \", response);\n      })\n    }\n\n    $scope.sync();\n\n    $scope.selectAll = function() {\n      for(var item of $scope.subItems) {\n        item.checked = !item.checked;\n      }\n    }\n\n    $scope.deselect = function(items) {\n      for(var item of items) {\n        item.checked = false;\n      }\n    }\n\n    $scope.pageSize = 200;\n\n    $scope.setItems = function(items) {\n      $rootScope.items = items;\n      $scope.currentItemsIndex = 0;\n      $scope.paginate();\n    }\n\n    $scope.paginate = function() {\n      $scope.subItems = $rootScope.items.slice($scope.currentItemsIndex, $scope.currentItemsIndex + $scope.pageSize);\n    }\n\n    $scope.paginatePrev = function() {\n      $scope.currentItemsIndex -= $scope.pageSize;\n      if($scope.currentItemsIndex < 0) {\n        $scope.currentItemsIndex = 0;\n      }\n      $scope.paginate();\n    }\n\n    $scope.paginateNext = function() {\n      if($scope.currentItemsIndex + $scope.pageSize >= $rootScope.items.length) {\n        $scope.currentItemsIndex = $rootScope.items.length - $scope.pageSize;\n      } else {\n        $scope.currentItemsIndex += $scope.pageSize;\n      }\n      $scope.paginate();\n    }\n\n    $scope.deleteSelectedWithSync = function() {\n      let selected = $scope.subItems.filter(function(item){return item.checked});\n\n      if(!confirm(`Are you sure you want to delete and sync ${selected.length} items?`)) {\n        return;\n      }\n\n      for(var item of selected) {\n        item.deleted = true;\n      }\n\n      var url = $rootScope.buildURL(\"items/sync\");\n      var request = Restangular.oneUrl(url, url);\n      request.items = selected;\n      request.sync_token = $scope.syncToken;\n      console.log(\"request items\", request.items);\n      request.post().then(function(response){\n        $scope.deselect(selected);\n        $scope.showDelete = false;\n        var savedItems = response.saved_items;\n        for(var savedItem of savedItems) {\n          var localItem = _.find($rootScope.items, {uuid: savedItem.uuid});\n          _.merge(localItem, savedItem);\n        }\n      })\n      .catch(function(response){\n        console.log(\"Error syncing:\", response);\n      })\n    }\n\n    $scope.destroySelected = function() {\n      let selected = $scope.subItems.filter(function(item){return item.checked});\n      if(!confirm(`Are you sure you want to delete and destroy ${selected.length} items?`)) {\n        return;\n      }\n\n      $scope.destroyItems(selected)\n    }\n\n    $scope.destroyAll = function() {\n      if(!confirm(`Danger: you are about to permanently delete all your items. Are you sure you want to delete and destroy ${$rootScope.items.length} items?`)) {\n        return;\n      }\n\n      $scope.destroyItems($rootScope.items)\n    }\n\n    $scope.destroyItems = function(items) {\n      var url = $rootScope.buildURL(\"items\");\n      var request = Restangular.oneUrl(url, url);\n      request.uuids = items.map(function(item){return item.uuid});\n      request.remove().then(function(response){\n        $scope.deselect(items);\n        console.log(\"destroy response\", response);\n        $rootScope.items = _.difference($rootScope.items, items);\n        $scope.subItems = _.difference($scope.subItems, items);\n      })\n      .catch(function(response){\n        console.log(\"destroy error:\", response);\n      })\n    }\n\n  }\n}\n\nangular.module('app').controller('DashboardCtrl', DashboardCtrl);\n;class ExtensionsCtrl {\n  constructor($rootScope, $scope, Restangular, $state, $stateParams) {\n\n    let extType = \"SF|Extension\";\n\n    function decodeContent(contentString) {\n      var jsonString = atob(contentString.slice(3, contentString.length));\n      var content = JSON.parse(jsonString);\n      return content;\n    }\n\n    $scope.getInitialExtensions = function() {\n      $scope.extensions = $rootScope.items.filter(function(item){\n        return item.content_type == extType;\n      })\n      $scope.decodeExtensions();\n    }\n\n    $scope.decodeExtensions = function() {\n      for(var ext of $scope.extensions) {\n        if(typeof ext.content === 'string' || ext.content instanceof String) {\n          ext.content = decodeContent(ext.content);\n        }\n      }\n    }\n\n    $scope.getInitialExtensions();\n\n    $scope.performBackupForExt = function(ext) {\n      if(!confirm(\"Performing an initial backup can take several minutes, depending on the number of items you have. You do not have to stick around for this process to complete.\")) {\n        return;\n      }\n\n      ext.performingBackup = true;\n\n      var url = $scope.buildURL(\"items/backup\");\n      var request = Restangular.oneUrl(url, url);\n      request.uuid = ext.uuid;\n      request.post().then(function(response){\n        ext.performingBackup = false;\n        console.log(\"Perform backup success: \", response);\n      })\n      .catch(function(response){\n        ext.performingBackup = false;\n        alert(\"There was an error performing this backup. Please try again. Error: \" + response.plain());\n        console.log(\"Perform backup error:\", response);\n      })\n    }\n\n    $scope.formData = {url: \"\"};\n    $scope.addExtension = function() {\n      var content = {\n        url: $scope.formData.url\n      };\n\n      var encodedContent = \"000\" + btoa(JSON.stringify(content));\n      var ext = {content_type: extType, content: encodedContent};\n\n      var url = $scope.buildURL(\"items\")\n      var request = Restangular.oneUrl(url, url);\n      request.item = ext;\n      request.post().then(function(response){\n        console.log(\"response:\", response);\n        $scope.extensions.push(response.plain().item);\n        $scope.decodeExtensions();\n      })\n      .catch(function(response){\n        console.log(\"error adding ext:\", response);\n      })\n    }\n\n  }\n}\n\nangular.module('app').controller('ExtensionsCtrl', ExtensionsCtrl);\n;class HomeCtrl {\n  constructor($rootScope, $scope, Restangular, $state, $stateParams) {\n\n    $scope.formData = {};\n\n    if($stateParams.server) {\n      $scope.formData.server = $stateParams.server;\n    } else {\n      $scope.formData.server = \"https://n3.standardnotes.org\";\n    }\n\n    $scope.formData.email = $stateParams.id;\n    $scope.formData.password = $stateParams.pw;\n\n    $scope.submitLogin = function() {\n      var url = $scope.formData.server + \"/auth/sign_in\";\n      var request = Restangular.oneUrl(url, url);\n      request.email = $scope.formData.email;\n      request.password = $scope.formData.password;\n      request.post().then(function(response) {\n        console.log(\"Success:\", response);\n        sessionStorage.setItem(\"jwt\", response.token);\n        sessionStorage.setItem(\"server\", $scope.formData.server);\n        sessionStorage.setItem(\"user\", JSON.stringify(response.user));\n        $rootScope.signedIn = true;\n      })\n      .catch(function(response){\n        console.log(\"error:\", response);\n        $scope.formData.error = response.data.error;\n      })\n    }\n\n  }\n}\n\nangular.module('app').controller('HomeCtrl', HomeCtrl);\n;angular.module('app')\n  .config(function ($stateProvider, $urlRouterProvider, $locationProvider) {\n\n    $stateProvider\n      .state('base', {\n        abstract: true,\n      })\n\n      .state('home', {\n        url: '/?server&id&pw',\n        parent: 'base',\n        views: {\n          'content@' : {\n            templateUrl: 'templates/home.html',\n            controller: 'HomeCtrl'\n          }\n        }\n      })\n\n      // 404 Error\n      .state('404', {\n        parent: 'base',\n        views: {\n          'content@' : {\n            templateUrl: 'errors/404.html'\n          }\n        }\n      });\n\n      // Default fall back route\n      $urlRouterProvider.otherwise(function($injector, $location){\n         var state = $injector.get('$state');\n         state.go('404');\n         return $location.path();\n      });\n\n      // enable HTML5 Mode for SEO\n      $locationProvider.html5Mode(true);\n\n  });\n"]}